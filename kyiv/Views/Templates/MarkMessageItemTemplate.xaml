<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="kyiv.Views.Templates.MarkMessageItemTemplate"
             xmlns:model="clr-namespace:kyiv.Models"
             x:DataType="model:MarkModel">

    <!-- Додаємо ресурси для кольорів -->
    <ContentView.Resources>
        <ResourceDictionary>
            <Color x:Key="DarkBackgroundMarkColor">#1a1a1a</Color>
            <Color x:Key="WhiteBackgroundMarkColor">#afafd5</Color>
            <Color x:Key="WhiteTextColor">#d8d8e4</Color>
            <Color x:Key="BlackTextColor">#232324</Color>
        </ResourceDictionary>
    </ContentView.Resources>

    <Grid ColumnDefinitions="*" 
          RowDefinitions="Auto"
          HorizontalOptions="Fill" 
          VerticalOptions="Start">

        <!-- Border займає всю ширину екрана -->
        <Border Margin="12" 
                HorizontalOptions="Fill" 
                VerticalOptions="Start"
                Padding="10"
                BackgroundColor="{AppThemeBinding Light={DynamicResource WhiteBackgroundMarkColor}, Dark={DynamicResource DarkBackgroundMarkColor}}"
                Stroke="Transparent"
                StrokeShape="RoundRectangle 10"
                StrokeThickness="1">

            <!-- Внутрішній Grid для вмісту -->
            <Grid RowDefinitions="Auto, Auto, Auto, *" 
                  RowSpacing="5" 
                  ColumnDefinitions="2*,*"
                  HorizontalOptions="Fill">

                <!-- Ім'я користувача -->
                <Label Grid.Column="0" Grid.Row="0" Grid.RowSpan="2"
                       Text="{Binding Name}" 
                       FontAttributes="Bold" 
                       FontSize="16"
                       LineBreakMode="TailTruncation"
                       HorizontalOptions="Start"
                       TextColor="{AppThemeBinding Light={StaticResource BlackTextColor}, Dark={StaticResource WhiteTextColor}}" />

                <!-- Дата створення -->
                <Label Grid.Column="1" Grid.Row="0" 
                       HorizontalOptions="End"
                       Text="{Binding WritenAt, StringFormat='{0:dd.MM.yyyy HH:mm}'}"
                       FontSize="12"
                       TextColor="{AppThemeBinding Light={StaticResource BlackTextColor}, Dark={StaticResource WhiteTextColor}}" />

                <!-- Тема коментаря -->
                <Label Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="2"
                       Text="{Binding Topic}" 
                       FontAttributes="Bold" 
                       FontSize="14"
                       LineBreakMode="TailTruncation"
                       MaxLines="1"
                       HorizontalOptions="Fill"
                       TextColor="{AppThemeBinding Light={StaticResource BlackTextColor}, Dark={StaticResource WhiteTextColor}}" />

                <!-- Текст коментаря -->
                <Label Grid.Column="0" Grid.Row="2" Grid.ColumnSpan="2"
                       Text="{Binding Text}" 
                       LineBreakMode="WordWrap"
                       MaxLines="5"
                       Margin="0,5,0,5"
                       HorizontalOptions="Start"
                       VerticalOptions="Fill"
                       TextColor="{AppThemeBinding Light={StaticResource BlackTextColor}, Dark={StaticResource WhiteTextColor}}">
                    <Label.Triggers>
                        <!-- Виправлений DataTrigger -->
                        <DataTrigger TargetType="Label"
                                     Binding="{Binding Text.Length}"
                                     Value="300">
                            <Setter Property="MaxLines" Value="0" />
                        </DataTrigger>
                    </Label.Triggers>
                </Label>

            </Grid>
        </Border>
    </Grid>
</ContentView>